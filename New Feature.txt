All the code for this great new feature.